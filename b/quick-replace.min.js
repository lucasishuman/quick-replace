window.quickReplace=function(e,t,n,r){var i="http://quick-replace.com/b/",s="QKRP",o=null,u=null,a=null,f=!1,l=!1,c=function(){u=e(t.body);f=n.File&&n.FileReader;e("head").append(e("<link />",{href:i+"quick-replace.css",rel:"stylesheet",id:s+"-styles"}));o=e("<div />",{"class":s+"-info"});u.append(o);o.hide();a=e("<a />",{href:"#",title:"Exit Quick Replace","class":s+"-btn-close"}).text("X").click(function(e){e.preventDefault();p()});u.append(a);h()},h=function(){l=!0;a.show();u.on("click."+s,function(t){var r=e(t.target),i=r.prop("tagName"),o=v(r.text()),u;if(r.hasClass(s+"-btn-close"))return;t.preventDefault();t.stopPropagation();if(o.length===0)return;u=n.prompt("Edit "+i.toUpperCase()+" text",o);u&&r.text(u)});u.on("mouseover."+s,function(t){var n=e(t.target),r=n.prop("tagName"),i=v(n.text()),a=n.offset(),f=m(i),l=g(i),c=f===1?"":"s",h=l===1?"":"s",p=0,d=0,b="";if(n.hasClass(s+"-btn-close"))return;t.preventDefault();n.addClass(s+"-mouse-over");b+='<span class="tag-name">'+r+":</span> ";if(r.toLowerCase()==="img")b+=y(n);else{b+=f+" char"+c+", ";b+=l+" word"+h}o.html(b);o.show();p=a.top-(o.outerHeight()+2);d=a.left-2;p<0&&(p=a.top+n.height()+2);p+o.outerHeight()>u.height()&&(p=u.height()-o.height());o.css({top:p+"px",left:d+"px"})});u.on("mouseout."+s,function(t){var n=e(t.target);if(n.hasClass(s+"-btn-close"))return;t.preventDefault();n.removeClass(s+"-mouse-over");o.hide()});if(!f)return;u.on("dragenter."+s,"img",function(t){var n=e(t.target);t.preventDefault();n.addClass(s+"-drag-over")});u.on("dragleave."+s,"img",function(t){var n=e(t.target);t.preventDefault();n.removeClass(s+"-drag-over")});u.on("dragover."+s,"img",function(e){e.preventDefault();e.originalEvent.dataTransfer.dropEffect="copy"});u.on("drop."+s,"img",function(t){var r=e(t.target),i=t.originalEvent.dataTransfer.files||[],o,u,a;t.preventDefault();t.stopPropagation();r.removeClass(s+"-drag-over");if(i.length===0){console.log("No files to load...");return}o=i[0];u=o.type.toLowerCase();if(!u.match("image.*")){n.alert("Not a valid image format - try GIF, JPG or PNG");return}a=new FileReader;a.onload=function(){r.attr("src",this.result)};a.onerror=function(){n.alert("Could not load image!")};a.readAsDataURL(o)})},p=function(){l=!1;a.hide();o.hide();u.off("click."+s);u.off("mouseover."+s);u.off("mouseout."+s);if(!f)return;u.off("dragenter."+s);u.off("dragleave."+s);u.off("dragover."+s);u.off("drop."+s)},d=function(){l?p():h()},v=function(t){t=e.trim(t);t=t.replace(/\s+/g," ");return t},m=function(e){return e.length},g=function(e){return e.length===0?0:e.split(/\s+/).length},y=function(e){var t="",n=e.width(),r=e.height(),i=new Image,s,o;i.src=e.attr("src");s=i.width;o=i.height;t=n+" x "+r;if(s!==n||o!==r)t+=" (Natural: "+s+" x "+o+")";return t};c();return{enable:h,disable:p,toggle:d}};(function(){var e,t=function(){window.quickReplace=window.quickReplace(window.jQuery,document,window)};if(window.jQuery&&window.jQuery.fn.jquery>="1.8.3")t();else{e=document.createElement("script");e.src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js";e.onload=function(){t()};document.body.appendChild(e)}})();(function(){var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],r=n.length,i=window.console=window.console||{};while(r--){e=n[r];i[e]||(i[e]=t)}})();